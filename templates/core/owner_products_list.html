{% extends "base.html" %}
{% load i18n %}
{% block title %}{{ org.name }} - {% trans "Ürünler" %}{% endblock %}
{% block content %}
<div class="card shadow-sm">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">{{ org.name }} - {% trans "Tedarikçi Ürünleri" %}</h5>
    <form method="get" class="d-flex gap-2 align-items-center">
      <input type="text" class="form-control form-control-sm" name="q" placeholder="{% trans "Ara (ürün/tedarikçi)" %}" value="{{ q }}" />
      <button class="btn btn-sm btn-outline-secondary" type="submit">{% trans "Ara" %}</button>
      {% if 'products_manage' in tenant_permissions %}
      <a class="btn btn-sm btn-primary" href="{% url 'owner_products_new' %}">{% trans "Yeni Ürün" %}</a>
      {% endif %}
    </form>
  </div>
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-sm align-middle">
        <thead class="table-light">
          <tr>
            <th>{% trans "Ürün" %}</th>
            <th>{% trans "Tedarikçi" %}</th>
            <th>{% trans "Kategori" %}</th>
            <th>{% trans "Müşteri" %}</th>
            <th>{% trans "Liste Fiyatı" %}</th>
            <th>{% trans "Durum" %}</th>
            {% if 'products_manage' in tenant_permissions %}
            <th class="text-end">{% trans "İşlemler" %}</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for p, buyers_list in rows %}
            <tr>
              <td>{{ p.name }}</td>
              <td>{{ p.supplier.name }}</td>
              <td>{{ p.category.name }}</td>
              <td>{% if p.customer %}{{ p.customer.name }}{% else %}<span class="badge text-bg-info">Genel</span>{% endif %}</td>
              <td>{% if p.base_price %}{{ p.base_price }}{% else %}-{% endif %}</td>
              <td>{% if p.is_active %}<span class="badge text-bg-success">{% trans "Aktif" %}</span>{% else %}<span class="badge text-bg-secondary">{% trans "Pasif" %}</span>{% endif %}</td>
              {% if 'products_manage' in tenant_permissions %}
              <td class="text-end">
                <a href="{% url 'owner_products_edit' p.pk %}" class="btn btn-sm btn-outline-primary" title="{% trans 'Düzenle' %}"><i class="bi bi-pencil"></i></a>
                <a href="{% url 'owner_products_delete' p.pk %}" class="btn btn-sm btn-outline-danger" title="{% trans 'Sil' %}"><i class="bi bi-trash"></i></a>
              </td>
              {% endif %}
            </tr>
          {% empty %}
            <tr><td colspan="{% if 'products_manage' in tenant_permissions %}7{% else %}6{% endif %}" class="text-center text-muted">{% trans "Ürün yok" %}</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
